library(tidyverse)
library(arm)
library(rstanarm)
arsi_full_data <- read_csv("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/arsi_full_data.csv")
names(arsi_full_data)
names(arsi_full_data)[4:24] <- c('Protein','Fe.crop','Zn.crop','Area','FoodYield','WheatYield','N.appl.amt','N.appl.p.ha','SIR','POM.C','MAOM.C','POM.N','MAOM.N','Sand','Silt','Clay','pH','Cu','Fe','Mn','Zn')
arsi_full_data$Protein <- arsi_full_data$Protein/100
arsi_full_data$MAOM.C.N <- arsi_full_data$MAOM.C/arsi_full_data$MAOM.N
arsi_full_data$POM.C.N <- arsi_full_data$POM.C/arsi_full_data$POM.N
arsi_full_data$Fines <- arsi_full_data$Silt + arsi_full_data$Clay
arsi_full_data$N.sq <- arsi_full_data$N.appl.p.ha^2
attach(arsi_full_data)
lm.yield <- lm(log(WheatYield)~N.appl.p.ha + Trd + pH + Silt + POM.C + MAOM.C)
summary(standardize(lm.yield))
panel.cor <- function(x, y, digits = 2, cex.cor, ...)
{
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- abs(cor(x, y,use = "complete.obs"))
txt <- format(c(r, 0.123456789), digits = digits)[1]
if(missing(cex.cor)) cex.cor <- 1/(strwidth(txt))
cex.final = cex.cor * r
if(cex.final < .5) cex.final <- .6
text(0.5, 0.5, txt, cex = cex.final)
}
names(arsi_full_data)
pairs(arsi_full_data[,c(9,10,11,13:24,28,29,34:37)], lower.panel = panel.smooth, upper.panel = panel.cor)
hist(WheatYield)
hist(log(WheatYield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Sand+Mn+Zn+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Mn+Zn+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Zn+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Drd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C.N+POM.C.N+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.C.N+Trd)
summary(standardize(lm.yield))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(standardize(lm.yield))
lm.zn <- lm(log(Zn.crop)~ Zn + Sand + pH + DCG + POM.C + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + pH + DCG + POM.C + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + pH + DCG + POM.N + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + DCG + POM.N + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + Trd + pH + POM.N + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + DCG + pH + POM.N + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + Dmun + pH + POM.N + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + pH + POM.N + MAOM.C)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + pH + POM.N + MAOM.C + Sand)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + DCG + pH + POM.N + MAOM.C + Sand)
summary(standardize(lm.zn))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.C + MAOM.C)
summary(standardize(lm.fe))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.N + MAOM.C)
summary(standardize(lm.fe))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.C.N)
summary(standardize(lm.fe))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.N)
summary(standardize(lm.fe))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.C)
summary(standardize(lm.fe))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.C.N)
summary(standardize(lm.fe))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.C)
summary(standardize(lm.fe))
lm.zn <- lm(log(Zn.crop)~ Zn + DCG + pH + POM.N + MAOM.C + Sand)
summary(standardize(lm.zn))
lm.zn <- lm(log(Zn.crop)~ Zn + DCG + pH + MAOM.C + Sand)
summary(standardize(lm.zn))
lm.fe <- lm(log(Fe.crop)~ Fe + DCG + pH + Sand + POM.C)
summary(standardize(lm.fe))
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(standardize(lm.yield))
plot(MAOM.C~POM.N)
corr(MAOM.C,POM.N)
cor(MAOM.C,POM.N)
cor(MAOM.C,POM.N,na.rm=T)
qqPlot(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
arm::qqPlot(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
??qqPlot
car::qqPlot(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
ncvTest(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
car::ncvTest(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
car::residualPlots(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
car::crPlots(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
car::avPlots(llm(log(WheatYield)~MAOM.C+POM.N+Trd))
car::avPlots(lm(log(WheatYield)~MAOM.C+POM.N+Trd))
yield <- stan_lm(log(WheatYield)~ MAOM.C+POM.N+Trd, prior=R2(location=0.5),data = arsi_full_data)
yield
pp_check(yield)
shinystan::launch_shinystan(yield)
stan.data$WheatYield <- arsi_full_data$WheatYield
stan.data <- data.frame()
stan.data$WheatYield <- arsi_full_data$WheatYield
help(data.frame)
stan.data <- as.data.frame(arsi_full_data$WheatYield)
head(stan.data)
stan.data$MAOM.C.z <- (MAOM.C - mean(MAOM.C,na.rm=T))/2*sd(MAOM.C)
stan.data$POM.N.z <- (POM.N - mean(POM.N,na.rm=T))/2*sd(POM.N)
stan.data$Trd <- (Trd - mean(Trd,na.rm=T))/2*sd(Trd)
head(stan.data)
stan.data$MAOM.C.z <- (MAOM.C - mean(MAOM.C,na.rm=T))/2*sd(MAOM.C,na.rm=T)
stan.data$POM.N.z <- (POM.N - mean(POM.N,na.rm=T))/2*sd(POM.N,na.rm=T)
stan.data$Trd <- (Trd - mean(Trd,na.rm=T))/2*sd(Trd,na.rm=T)
head(stan.data)
yield <- stan_lm(log(WheatYield)~ MAOM.C+POM.N+Trd, prior=R2(location=0.5),data = stan.data)
names(stan.data)
names(stan.data)[1] <- "WheatYield"
stan.data$Trd.z <- (Trd - mean(Trd,na.rm=T))/2*sd(Trd,na.rm=T)
yield <- stan_lm(log(WheatYield)~ MAOM.C.z+POM.N.z+Trd.z, prior=R2(location=0.5),data = stan.data)
yield
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(standardize(lm.yield))
stan.data <- as.data.frame(WheatYield)
stan.data$MAOM.C.z <- (MAOM.C - mean(MAOM.C,na.rm=T))/2*sd(MAOM.C,na.rm=T)
stan.data$POM.N.z <- (POM.N - mean(POM.N,na.rm=T))/2*sd(POM.N,na.rm=T)
stan.data$Trd.z <- (Trd - mean(Trd,na.rm=T))/2*sd(Trd,na.rm=T)
names(stan.data)[1] <- "WheatYield"
names(stan.data)
lm.yield.z <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(lm.yield)
hist(Trd)
hist(MAOM.C)
hist(POM.N)
hist(MAOM.C.z)
lm.yield.z <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(lm.yield)
yield <- stan_lm(log(WheatYield)~ MAOM.C.z+POM.N.z+Trd.z, prior=R2(location=0.5),data = stan.data)
yield
lm.yield <- lm(log(WheatYield)~MAOM.C+POM.N+Trd)
summary(standardize(lm.yield))
lm.yield.z <- lm(log(WheatYield)~MAOM.C.z+POM.N.z+Trd.z)
lm.yield.z <- lm(log(WheatYield)~MAOM.C.z+POM.N.z+Trd.z,data=stan.data)
summary(lm.yield)
yield <- stan_lm(log(WheatYield)~ MAOM.C.z+POM.N.z+Trd.z, prior=R2(location=0.64),data = stan.data)
yield
yield <- stan_lm(log(WheatYield)~ MAOM.C.z+POM.N.z+Trd.z, prior=R2(location=0.6),data = stan.data)
yield <- stan_lm(WheatYield~ MAOM.C.z+POM.N.z+Trd.z, prior=R2(location=0.6),data = stan.data)
stan.data <- as.data.frame(log(WheatYield))
stan.data$MAOM.C.z <- (MAOM.C - mean(MAOM.C,na.rm=T))/2*sd(MAOM.C,na.rm=T)
stan.data$POM.N.z <- (POM.N - mean(POM.N,na.rm=T))/2*sd(POM.N,na.rm=T)
stan.data$Trd.z <- (Trd - mean(Trd,na.rm=T))/2*sd(Trd,na.rm=T)
names(stan.data)[1] <- "WheatYield"
detach(arsi_full_data)
arsi_full_data$ln.wheat <- as.data.frame(log(arsi_full_data$WheatYield))
arsi_full_data$MAOM.C.z <- (arsi_full_data$MAOM.C - mean(arsi_full_data$MAOM.C,na.rm=T))/2*sd(arsi_full_data$MAOM.C,na.rm=T)
arsi_full_data$POM.N.z <- (arsi_full_data$POM.N - mean(arsi_full_data$POM.N,na.rm=T))/2*sd(arsi_full_data$POM.N,na.rm=T)
arsi_full_data$Trd.z <- (arsi_full_data$Trd - mean(Tarsi_full_data$rd,na.rm=T))/2*sd(arsi_full_data$Trd,na.rm=T)
arsi_full_data$MAOM.C.z <- (arsi_full_data$MAOM.C - mean(arsi_full_data$MAOM.C,na.rm=T))/2*sd(arsi_full_data$MAOM.C,na.rm=T)
arsi_full_data$POM.N.z <- (arsi_full_data$POM.N - mean(arsi_full_data$POM.N,na.rm=T))/2*sd(arsi_full_data$POM.N,na.rm=T)
arsi_full_data$Trd.z <- (arsi_full_data$Trd - mean(arsi_full_data$Trd,na.rm=T))/2*sd(arsi_full_data$Trd,na.rm=T)
names(arsi_full_data)
lm.yield.z <- lm(ln.wheat~MAOM.C.z+POM.N.z+Trd.z,data=arsi_full_data)
is(ln.wheat)
arsi_full_data$ln.wheat <- as.data.frame(log(arsi_full_data$WheatYield))
arsi_full_data$ln.wheat
names(arsi_full_data)
arsi_full_data$ln.wheat
arsi_full_data$ln.wheat <- log(arsi_full_data$WheatYield)
lm.yield.z <- lm(ln.wheat~MAOM.C.z+POM.N.z+Trd.z,data=arsi_full_data)
summary(lm.yield)
yield <- stan_lm(ln.wheat~ MAOM.C.z+POM.N.z+Trd.z, prior=R2(location=0.6),data = arsi_full_data)
yield
help('prior_summary.stanreg')
pp_check(yield)
names(arsi_full_data)
ncols(as.matrix(arsi_full_data[,41:43]))
ncol(as.matrix(arsi_full_data[,41:43]))
nrow(as.matrix(arsi_full_data[,41:43]))
dataList <- list(X=as.matrix(arsi_full_data[,41:43]),y=arsi_full_data$ln.wheat,N=nrow(as.matrix(arsi_full_data[,41:43])),K=ncol(as.matrix(arsi_full_data[,41:43])))
dataList
dataList <- list(xTrd=arsi_full_data$Trd.z,xPOM=arsi_full_data$POM.N.z,xMAOM=arsi_full_data$MAOM.C.z,y=arsi_full_data$ln.wheat,N=nrow(as.matrix(arsi_full_data[,41:43])),K=ncol(as.matrix(arsi_full_data[,41:43])))
setwd("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan")
dataList <- list(xTrd=arsi_full_data$Trd.z,xPOM=arsi_full_data$POM.N.z,xMAOM=arsi_full_data$MAOM.C.z,y=arsi_full_data$ln.wheat,N=nrow(as.matrix(arsi_full_data[,41:43])),K=ncol(as.matrix(arsi_full_data[,41:43])))
modResults = rstan::stan(file="~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield.lm.stan",data=c(N=nrow()),iter=2000,warmup=1000)
dataList <- list(x=arsi_full_data$Trd.z,y=arsi_full_data$ln.wheat,N=nrow(as.matrix(arsi_full_data[,41:43])))
dataList <- list(x=arsi_full_data$Trd.z,y=arsi_full_data$ln.wheat,N=nrow(as.matrix(arsi_full_data[,41:43])))
modResults = rstan::stan(file="~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield.lm.stan",data=c(N=nrow()),iter=2000,warmup=1000)
nrow(as.matrix(arsi_full_data[,41:43]))
dataList <- list(x=arsi_full_data$Trd.z,y=arsi_full_data$ln.wheat,N=47)
modResults = rstan::stan(file="~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield.lm.stan",data=c(N=nrow()),iter=2000,warmup=1000)
dataList
nrow(dataList)
load("/Users/stephen.wood/Box Sync/Work/Conferences and Workshops/StanCon/linear-regression/kidiq.rda")
head(kidiq)
mod1 <- stan_model("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield.lm.stan")
mod1 <- stan_model("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan")
mod1 <- rstan::stan_model("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan")
mod1 <- rstan::stan_model("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan")
mod1 <- rstan::stan_model("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan")
mod1 <- rstan::stan_model("~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan")
data.list.1 <- c(N=47,
x=arsi_full_data$Trd.z,
y=arsi_full_data$ln.wheat)
kidscore_momhs <- stan(file = "~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan", data = data.list.1, iter = 500)
kidscore_momhs <- rstan::stan(file = "~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan", data = data.list.1, iter = 500)
data.list.1 <- c(N=47,
x=arsi_full_data$Trd.z,
y=arsi_full_data$ln.wheat)
kidscore_momhs <- rstan::stan(file = "~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan", data = data.list.1, iter = 500)
data.list.1
data.list.1 <- list(N=47,
x=arsi_full_data$Trd.z,
y=arsi_full_data$ln.wheat)
kidscore_momhs <- rstan::stan(file = "~/Box Sync/Work/Writing/Manuscripts/Unsubmitted/arsi_negele/Stan/yield_lm.stan", data = data.list.1, iter = 500)
kidscore_momhs
Sys.setenv(MAKEFLAGS = "-j4")
source('http://mc-stan.org/rstan/install.R', echo = TRUE, max.deparse.length = 2000)
install.packages("rstan")
install.packages("rstan")
install.packages("rstan")
install.packages("rstan")
install.packages("rstan")
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies=TRUE)
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies = TRUE)
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies = TRUE)
Sys.setenv(MAKEFLAGS = "-j4")
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies=TRUE)
install.packages("rstan", repos = "https://cloud.r-project.org/", dependencies = TRUE)
